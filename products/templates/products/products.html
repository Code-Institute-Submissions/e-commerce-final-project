{% extends 'home/base.html' %}
{% load static from staticfiles %}
{% load bootstrap_tags %}

{% block content %}

<form method="GET" action="{% url 'search' %}">
       <input name="q" value="{{request.GET.q}}" placeholder="search for products..">
       <button class="btn btn-success" type="submit" value="search">Search</button>
</form> 
<div class="container">

<div class="container-fluid">
  <div class="row">
    {% for product in items %}
    <div class="col-sm-4 col-lg-4 col-md-4">
      <div class="x_for_close">
              <div class="thumbnail">
              <a href="{% url 'product_detail' product.id %}"><img src="{{ MEDIA_URL}}{{product.image}}" width="200px" height="180px"></img></a> 
              <p>{{product.name}}</p>
              <p>P{{product.price}}</p>
             
                  <form method="POST" action="{% url 'add_to_cart' %}">
                      {% csrf_token %}
                      <input type="hidden" name="product_id" value="{{ product.id }}"/>
                      <input type="submit" value="Add To Cart"/>
                  </form>
              <p class="ratings">
              {% if product.reviews_received.all %}
              <p class="pull-right">{{product.reviews_received.all|length}} review</p>
              {% endif %} 
              {% if product.stars %} 
              {% for star in product.stars %}
              <i class="fas fa-star"></i> 
              {% endfor %} 
              {% if product.needs_half_star %}
              <i class="fa fa-star-half"></i> 
              {% endif %} 
              {{product.average_rating}} avg rating {% else %}
              <p><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>No reviews yet</p>
              {% endif %}
            </p>
            </div>
      </div> 
    </div> 
  {% endfor %}
  </div> 
  </div> 
</div> 
{% endblock content %}